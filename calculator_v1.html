<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Revenue Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f5f5f5;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        #calculator-root {
            width: 100%;
            max-width: 375px;
            height: 600px;
            position: relative;
        }
        
        .calc-container * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        .calc-container {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            width: 100%;
            height: 600px;
            background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
            border-radius: 20px;
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5);
            border: 3px solid #FFD700;
            overflow: hidden;
            position: relative;
            animation: breathingGlow 3s ease-in-out infinite;
            display: flex;
            flex-direction: column;
        }
        
        @keyframes slideInDown {
            from {
                opacity: 0;
                transform: translateY(-100px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        @keyframes breathingGlow {
            0%, 100% {
                box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5), 0 0 20px rgba(255, 215, 0, 0.4);
                border-color: #FFD700;
            }
            50% {
                box-shadow: 0 25px 50px rgba(0, 0, 0, 0.5), 0 0 40px rgba(255, 215, 0, 0.8);
                border-color: #FFA500;
            }
        }

        @keyframes flash {
            0% {
                opacity: 1;
                color: #32CD32;
                text-shadow: 0 0 5px #32CD32;
            }
            50% {
                opacity: 0.3;
                color: #90EE90;
                text-shadow: 0 0 10px #90EE90;
            }
            100% {
                opacity: 1;
                color: #32CD32;
                text-shadow: 0 0 5px #32CD32;
            }
        }

        .calc-container .flash-text {
            animation: flash 0.8s ease-in-out infinite;
            display: inline-block;
        }
        
        .calc-container .refresh-btn {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 14px;
            z-index: 10;
            transition: background 0.2s;
            backdrop-filter: blur(10px);
        }
        
        .calc-container .header {
            background: linear-gradient(135deg, #228B22 0%, #32CD32 100%);
            color: white;
            padding: 20px 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .calc-container .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='40' height='40' viewBox='0 0 40 40' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M20 20c0 11.046-8.954 20-20 20v-40c11.046 0 20 8.954 20 20zM0 20c0-11.046 8.954-20 20-20v40c-11.046 0-20-8.954-20-20z'/%3E%3C/g%3E%3C/svg%3E");
        }
        
        .calc-container .header h1 {
            font-size: 1.4rem;
            font-weight: 900;
            color: #FFD700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
            line-height: 1.2;
        }
        
        .calc-container .header-instruction {
            font-size: 0.9rem;
            color: #FFD700;
            font-weight: 600;
            position: relative;
            z-index: 1;
        }
        
        .calc-container .main-input-area {
            flex: 1;
            padding: 30px 25px;
            background: transparent;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 20px;
            transition: padding 0.3s ease, gap 0.3s ease;
        }
        
        .calc-container.compressed .main-input-area {
            padding: 15px 25px;
            gap: 10px;
        }
        
        .calc-container .question-container {
            width: 100%;
            text-align: center;
        }
        
        .calc-container .question-title {
            color: #FFD700;
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 20px;
            line-height: 1.3;
        }
        
        .calc-container .input-wrapper {
            width: 100%;
            margin-bottom: 15px;
        }
        
        .calc-container .main-select {
            width: 100%;
            padding: 18px 22px;
            border: 3px solid #FFD700;
            border-radius: 16px;
            font-size: 1.1rem;
            font-family: inherit;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            transition: all 0.3s ease;
            min-height: 60px;
            -webkit-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 16 16'%3E%3Cpath fill='%23FFD700' d='M13.854 5.146L8 10.999 2.146 5.146A.5.5 0 00.853 5.854L7.5 12.5a.707.707 0 001 0l6.647-6.646a.5.5 0 00-.293-.854z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 20px center;
            padding-right: 55px;
            cursor: pointer;
        }
        
        .calc-container .main-select:focus {
            outline: none;
            border-color: #FFA500;
            box-shadow: 0 0 25px rgba(255, 215, 0, 0.5);
            background-color: rgba(0, 0, 0, 0.9);
        }
        
        .calc-container .yes-no-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 15px;
        }
        
        .calc-container .yes-no-btn {
            flex: 1;
            padding: 18px 25px;
            border: 3px solid #FFD700;
            border-radius: 16px;
            background: rgba(0, 0, 0, 0.8);
            color: #FFD700;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-height: 60px;
        }
        
        .calc-container .yes-no-btn:hover {
            background: rgba(255, 215, 0, 0.1);
        }
        
        .calc-container .yes-no-btn.selected {
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            color: #000;
        }
        
        .calc-container .price-controls, .calc-container .customer-controls {
            display: flex;
            align-items: center;
            gap: 20px;
            justify-content: center;
            margin-bottom: 15px;
        }
        
        .calc-container .price-btn, .calc-container .customer-btn {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            color: #000;
            border: none;
            border-radius: 50%;
            font-size: 1.8rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
            user-select: none;
        }
        
        .calc-container .price-display {
            background: rgba(0,0,0,0.8);
            border: 3px solid #FFD700;
            border-radius: 16px;
            padding: 15px 25px;
            color: #FFD700;
            font-size: 1.6rem;
            font-weight: bold;
            min-width: 160px;
            text-align: center;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.4);
        }
        
        .calc-container .customer-display {
            background: rgba(0,0,0,0.8);
            border: 3px solid #FFD700;
            border-radius: 16px;
            padding: 15px 25px;
            color: #FFD700;
            min-width: 160px;
            text-align: center;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.4);
            display: flex;
            flex-direction: column;
            line-height: 1;
        }
        
        .calc-container .customer-number {
            font-size: 1.6rem;
            font-weight: bold;
            margin-bottom: 2px;
        }
        
        .calc-container .customer-label {
            font-size: 10pt;
            font-weight: normal;
            margin-bottom: 2px;
        }
        
        .calc-container .calculate-button {
            width: 100%;
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            color: #000;
            border: none;
            padding: 20px;
            border-radius: 16px;
            font-weight: 700;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.4);
            min-height: 60px;
        }
        
        .calc-container .step-indicator {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 20px;
        }
        
        .calc-container .step-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: rgba(255, 215, 0, 0.3);
            transition: all 0.3s ease;
        }
        
        .calc-container .step-dot.active {
            background: #FFD700;
            transform: scale(1.2);
        }
        
        .calc-container .step-dot.completed {
            background: #32CD32;
        }
        
        .calc-container .interaction-hint {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.8rem;
            margin-top: 10px;
        }
        
        .calc-container .tap-icon {
            color: #FFD700;
            font-size: 1rem;
        }

        .calc-container .disclaimer {
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid #FFD700;
            border-radius: 12px;
            padding: 12px;
            margin-top: 15px;
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.75rem;
            line-height: 1.3;
            text-align: center;
        }
        
        .calc-container .price-hint, .calc-container .customer-hint {
            text-align: center;
            color: rgba(255,255,255,0.7);
            font-size: 0.85rem;
            font-style: italic;
            margin-top: 10px;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            #calculator-root {
                max-width: 100%;
                height: auto;
                min-height: 600px;
            }
            
            .calc-container {
                height: auto;
                min-height: 600px;
            }
        }
    </style>
</head>
<body>
    <div id="calculator-root">
        <div class="calc-container">
            <button class="refresh-btn" onclick="refreshCalculator()" aria-label="Refresh calculator">🔄</button>

            <div class="header">
                <h1 id="headerTitle">DISCOVER YOUR HIDDEN REVENUE GOLDMINE</h1>
                <div class="header-instruction">Discover your annual revenue potential in 6 clicks</div>
            </div>
            
            <div class="main-input-area" id="mainInputArea">
                <div class="step-indicator" id="stepIndicator">
                    <div class="step-dot active"></div>
                    <div class="step-dot"></div>
                    <div class="step-dot"></div>
                    <div class="step-dot"></div>
                    <div class="step-dot"></div>
                    <div class="step-dot"></div>
                </div>
                
                <div class="question-container" id="questionContainer">
                    <!-- Questions will be dynamically inserted here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // Calculator state management
        let calculatorData = {
            businessType: '',
            mainService: '',
            servicePrice: 0,
            hasAdvertising: false,
            monthlyAdSpend: 0,
            customerCount: 500
        };
        
        let currentStep = 1;
        let isProcessing = false;
        let currentPrice = 0;
        let currentAdSpend = 0;
        let currentCustomers = 500;
        let priceTimeout = null;
        let adSpendTimeout = null;
        let customerTimeout = null;
        
        // A/B Testing Headlines
        const headerVariations = [
            { title: "DISCOVER YOUR HIDDEN REVENUE GOLDMINE" },
            { title: "YOUR CUSTOMERS ARE WAITING TO BUY AGAIN" },
            { title: "UNLOCK THOUSANDS IN DORMANT REVENUE" },
            { title: "CALCULATE THE REVENUE HIDING UNDER YOUR NOSE" },
            { title: "DISCOVER YOUR ANNUAL REVENUE POTENTIAL" }
        ];
        
        // Business Service Mappings
        const serviceMap = {
            'Car Detailing': ['Ceramic Coating', 'Paint Protection Film', 'Full Detail Package', 'Interior Deep Clean', 'Paint Correction'],
            'Cosmetic Surgery': ['Breast Augmentation', 'Tummy Tuck', 'Liposuction', 'Facelift', 'Brazilian Butt Lift'],
            'Cosmetic Dentistry': ['Veneers', 'Teeth Whitening', 'Dental Implants', 'Invisalign', 'Smile Makeover'],
            'Med Spa': ['Botox', 'Dermal Fillers', 'Laser Hair Removal', 'CoolSculpting', 'Chemical Peels'],
            'General Dentistry': ['Dental Implants', 'Crowns', 'Root Canal', 'Teeth Cleaning', 'Oral Surgery'],
            'Dermatology': ['Laser Treatments', 'Botox', 'Acne Treatment', 'Skin Cancer Screening', 'Chemical Peels'],
            'Hair Restoration': ['Hair Transplant', 'PRP Therapy', 'Scalp Micropigmentation', 'Hair Loss Treatment', 'FUE Procedure'],
            'Ophthalmology': ['LASIK Surgery', 'Cataract Surgery', 'Retinal Treatment', 'Glaucoma Treatment', 'Eye Exams'],
            'Chiropractic': ['Spinal Adjustment', 'Physical Therapy', 'Massage Therapy', 'Pain Management', 'Wellness Care']
        };
        
        // Industry-Specific Starting Prices
        const startingPrices = {
            'Car Detailing': 500, 'Cosmetic Surgery': 8000, 'Cosmetic Dentistry': 2000,
            'Med Spa': 800, 'General Dentistry': 1000, 'Dermatology': 600,
            'Hair Restoration': 8000, 'Ophthalmology': 4000, 'Chiropractic': 200
        };
        
        function updateStepIndicator(step) {
            const dots = document.querySelectorAll('.step-dot');
            dots.forEach((dot, index) => {
                dot.classList.remove('active', 'completed');
                if (index < step - 1) {
                    dot.classList.add('completed');
                } else if (index === step - 1) {
                    dot.classList.add('active');
                }
            });
        }
        
        function showBusinessTypeQuestion() {
            const container = document.getElementById('questionContainer');
            container.innerHTML = `
                <div class="question-title">Kevin's 1st 5-day campaign netted him $73K… <span style="color: #32CD32; font-weight: 800;" class="flash-text">LET'S CALCULATE YOURS!</span> What type of business do you run?</div>
                <div class="input-wrapper">
                    <select class="main-select" id="businessSelect" onchange="selectBusinessType()" aria-label="Select your business type">
                        <option value="">👆 Tap here to select your business type</option>
                        <option value="Car Detailing">Car Detailing</option>
                        <option value="Cosmetic Surgery">Cosmetic Surgery</option>
                        <option value="Cosmetic Dentistry">Cosmetic Dentistry</option>
                        <option value="Med Spa">Med Spa</option>
                        <option value="General Dentistry">General Dentistry</option>
                        <option value="Dermatology">Dermatology</option>
                        <option value="Hair Restoration">Hair Restoration</option>
                        <option value="Ophthalmology">Ophthalmology</option>
                        <option value="Chiropractic">Chiropractic</option>
                    </select>
                </div>
                <div class="interaction-hint">
                    <span class="tap-icon">👆</span>
                    Tap the dropdown to select your business type
                </div>
            `;
        }
        
        function selectBusinessType() {
            if (isProcessing) return;
            const select = document.getElementById('businessSelect');
            const value = select.value;
            if (!value) return;
            
            isProcessing = true;
            calculatorData.businessType = value;
            currentStep = 2;
            updateStepIndicator(currentStep);
            
            setTimeout(() => {
                showServiceQuestion();
                isProcessing = false;
            }, 500);
        }
        
        function showServiceQuestion() {
            const container = document.getElementById('questionContainer');
            const services = serviceMap[calculatorData.businessType] || ['Custom Service'];
            
            let optionsHTML = '<option value="">👆 Tap here to select your most profitable service</option>';
            services.forEach(service => {
                optionsHTML += `<option value="${service}">${service}</option>`;
            });
            
            container.innerHTML = `
                <div class="question-title">Which offering earns you the most profit?</div>
                <div class="input-wrapper">
                    <select class="main-select" id="serviceSelect" onchange="selectService()" aria-label="Select your most profitable service">
                        ${optionsHTML}
                    </select>
                </div>
                <div class="interaction-hint">
                    <span class="tap-icon">👆</span>
                    Select your highest profit margin service
                </div>
            `;
        }
        
        function selectService() {
            if (isProcessing) return;
            const select = document.getElementById('serviceSelect');
            const value = select.value;
            if (!value) return;
            
            isProcessing = true;
            calculatorData.mainService = value;
            currentStep = 3;
            updateStepIndicator(currentStep);
            
            setTimeout(() => {
                showPriceQuestion();
                isProcessing = false;
            }, 500);
        }
        
        function showPriceQuestion() {
            const container = document.getElementById('questionContainer');
            const startingPrice = startingPrices[calculatorData.businessType] || 500;
            currentPrice = startingPrice;
            
            container.innerHTML = `
                <div class="price-container">
                    <div class="question-title">What do you charge for ${calculatorData.mainService}?</div>
                    <div class="price-controls">
                        <button class="price-btn" onclick="adjustPrice(-50)" aria-label="Decrease price">−</button>
                        <div class="price-display" id="priceDisplay">${startingPrice.toLocaleString()}</div>
                        <button class="price-btn" onclick="adjustPrice(50)" aria-label="Increase price">+</button>
                    </div>
                    <div class="price-hint">Use +/- buttons to adjust • Auto-advances in 2 seconds</div>
                </div>
            `;
        }
        
        function adjustPrice(amount) {
            if (isProcessing) return;
            
            currentPrice += amount;
            if (currentPrice < 50) currentPrice = 50;
            if (currentPrice > 50000) currentPrice = 50000;
            
            document.getElementById('priceDisplay').textContent = `${currentPrice.toLocaleString()}`;
            
            if (priceTimeout) clearTimeout(priceTimeout);
            
            priceTimeout = setTimeout(() => {
                selectPrice();
            }, 2000);
        }
        
        function selectPrice() {
            if (isProcessing) return;
            
            isProcessing = true;
            calculatorData.servicePrice = currentPrice;
            currentStep = 4;
            updateStepIndicator(currentStep);
            
            setTimeout(() => {
                showAdvertisingQuestion();
                isProcessing = false;
            }, 500);
        }
        
        function showAdvertisingQuestion() {
            const container = document.getElementById('questionContainer');
            container.innerHTML = `
                <div class="question-title">Are you currently spending money on paid advertising? (Google Ads, Facebook Ads, etc.)</div>
                <div class="yes-no-buttons">
                    <button class="yes-no-btn" id="yesBtn" onclick="selectAdvertising(true)">Yes</button>
                    <button class="yes-no-btn" id="noBtn" onclick="selectAdvertising(false)">No</button>
                </div>
                <div class="interaction-hint">
                    <span class="tap-icon">👆</span>
                    Tap Yes or No to continue
                </div>
            `;
        }
        
        function selectAdvertising(hasAds) {
            if (isProcessing) return;
            
            isProcessing = true;
            calculatorData.hasAdvertising = hasAds;
            
            document.getElementById('yesBtn').classList.toggle('selected', hasAds);
            document.getElementById('noBtn').classList.toggle('selected', !hasAds);
            
            currentStep = 5;
            updateStepIndicator(currentStep);
            
            setTimeout(() => {
                if (hasAds) {
                    showAdSpendQuestion();
                } else {
                    calculatorData.monthlyAdSpend = 0;
                    currentStep = 6;
                    updateStepIndicator(currentStep);
                    setTimeout(() => {
                        showCustomerQuestion();
                    }, 300);
                }
                isProcessing = false;
            }, 800);
        }
        
        function showAdSpendQuestion() {
            const container = document.getElementById('questionContainer');
            currentAdSpend = 2000;
            
            container.innerHTML = `
                <div class="price-container">
                    <div class="question-title">What do you spend monthly on advertising?</div>
                    <div class="price-controls">
                        <button class="price-btn" onclick="adjustAdSpend(-100)" aria-label="Decrease ad spend">−</button>
                        <div class="price-display" id="adSpendDisplay">${currentAdSpend.toLocaleString()}</div>
                        <button class="price-btn" onclick="adjustAdSpend(100)" aria-label="Increase ad spend">+</button>
                    </div>
                    <div class="price-hint">Use +/- buttons to adjust • Auto-advances in 2 seconds</div>
                </div>
            `;
        }
        
        function adjustAdSpend(amount) {
            if (isProcessing) return;
            
            currentAdSpend += amount;
            if (currentAdSpend < 100) currentAdSpend = 100;
            if (currentAdSpend > 50000) currentAdSpend = 50000;
            
            document.getElementById('adSpendDisplay').textContent = `${currentAdSpend.toLocaleString()}`;
            
            if (adSpendTimeout) clearTimeout(adSpendTimeout);
            
            adSpendTimeout = setTimeout(() => {
                selectAdSpend();
            }, 2000);
        }
        
        function selectAdSpend() {
            if (isProcessing) return;
            
            isProcessing = true;
            calculatorData.monthlyAdSpend = currentAdSpend;
            currentStep = 6;
            updateStepIndicator(currentStep);
            
            setTimeout(() => {
                showCustomerQuestion();
                isProcessing = false;
            }, 500);
        }
        
        function showCustomerQuestion() {
            const container = document.getElementById('questionContainer');
            currentCustomers = 500;
            
            container.innerHTML = `
                <div class="customer-container">
                    <div class="question-title">How many past customers have you served that you would love to see <span style="color: #32CD32; font-weight: 800;">spend with you again</span>? (Kevin had 780) Your best guess.</div>
                    <div class="customer-controls">
                        <button class="customer-btn" onclick="adjustCustomers(-10)" aria-label="Decrease customer count">−</button>
                        <div class="customer-display" id="customerDisplay">
                            <div class="customer-number">${currentCustomers}</div>
                            <div class="customer-label">dormant</div>
                            <div class="customer-label">customers</div>
                        </div>
                        <button class="customer-btn" onclick="adjustCustomers(10)" aria-label="Increase customer count">+</button>
                    </div>
                    <div class="customer-hint">Use +/- buttons to adjust by 10 • Auto-advances in 2 seconds</div>
                </div>
            `;
        }
        
        function adjustCustomers(amount) {
            if (isProcessing) return;
            
            currentCustomers += amount;
            if (currentCustomers < 10) currentCustomers = 10;
            if (currentCustomers > 10000) currentCustomers = 10000;
            
            document.getElementById('customerDisplay').innerHTML = `
                <div class="customer-number">${currentCustomers.toLocaleString()}</div>
                <div class="customer-label">dormant</div>
                <div class="customer-label">customers</div>
            `;
            
            if (customerTimeout) clearTimeout(customerTimeout);
            
            customerTimeout = setTimeout(() => {
                selectCustomers();
            }, 2000);
        }
        
        function selectCustomers() {
            if (isProcessing) return;
            
            isProcessing = true;
            calculatorData.customerCount = currentCustomers;
            
            setTimeout(() => {
                showCalculateButton();
                isProcessing = false;
            }, 500);
        }
        
        function showCalculateButton() {
            const container = document.getElementById('questionContainer');
            container.innerHTML = `
                <div class="question-title">Perfect! See your annual revenue potential vs advertising costs</div>
                <div class="input-wrapper">
                    <button class="calculate-button" onclick="calculateAdvancedRevenue()">Calculate My ROI</button>
                </div>
                <div class="disclaimer">
                    Projections are estimates based on inputs provided and industry data. Actual results vary significantly based on individual business factors. No earnings are guaranteed. This tool is for informational purposes only and does not constitute financial or business advice.
                </div>
                <div class="interaction-hint">
                    <span class="tap-icon">🚀</span>
                    Tap to reveal your annual revenue potential
                </div>
            `;
        }
        
        function calculateAdvancedRevenue() {
            // Revenue calculation logic
            const initialResponseRate = 0.18;
            const emailFatigueDecline = 0.15;
            const monthlyDatabaseGrowth = 0.10;
            
            let totalAnnualRevenue = 0;
            let currentCustomerBase = calculatorData.customerCount;
            let currentResponseRate = initialResponseRate;
            
            for (let month = 1; month <= 12; month++) {
                const expectedResponses = Math.round(currentCustomerBase * currentResponseRate);
                const monthlyRevenue = expectedResponses * calculatorData.servicePrice;
                
                totalAnnualRevenue += monthlyRevenue;
                
                currentCustomerBase *= (1 + monthlyDatabaseGrowth);
                currentResponseRate *= (1 - emailFatigueDecline);
                
                if (currentResponseRate < 0.05) currentResponseRate = 0.05;
            }
            
            const annualAdSpend = calculatorData.monthlyAdSpend * 12;
            const weeklyRevenuePotential = totalAnnualRevenue / 52;
            const weeklyAdWaste = calculatorData.monthlyAdSpend / 4.33;
            const totalWeeklyCostOfDelay = weeklyRevenuePotential + (calculatorData.hasAdvertising ? weeklyAdWaste : 0);
            
            // Calculate profit margin (simplified calculation)
            const estimatedMargin = calculateEstimatedMargin();
            
            // Prepare redirect parameters in the required format
            const queryParams = new URLSearchParams({
                customers: calculatorData.customerCount,
                service: calculatorData.mainService,
                margin: Math.round(estimatedMargin),
                roi: Math.round(totalAnnualRevenue / 12), // Monthly ROI
                weeklyLoss: Math.round(totalWeeklyCostOfDelay)
            });
            
            // Track calculation completion
            console.log('Calculator completed with data:', {
                businessType: calculatorData.businessType,
                service: calculatorData.mainService,
                price: calculatorData.servicePrice,
                customers: calculatorData.customerCount,
                annualRevenue: Math.round(totalAnnualRevenue),
                monthlyROI: Math.round(totalAnnualRevenue / 12),
                weeklyLoss: Math.round(totalWeeklyCostOfDelay)
            });
            
            // Redirect to big-reveal.html with required parameters
            const redirectUrl = `big-reveal.html?${queryParams.toString()}`;
            console.log('Redirecting to:', redirectUrl);
            window.location.href = redirectUrl;
        }
        
        function calculateEstimatedMargin() {
            // Industry-based margin estimates
            const marginEstimates = {
                'Car Detailing': 65,
                'Cosmetic Surgery': 75,
                'Cosmetic Dentistry': 70,
                'Med Spa': 80,
                'General Dentistry': 60,
                'Dermatology': 70,
                'Hair Restoration': 75,
                'Ophthalmology': 65,
                'Chiropractic': 55
            };
            
            return marginEstimates[calculatorData.businessType] || 60;
        }
        
        function refreshCalculator() {
            calculatorData = {
                businessType: '',
                mainService: '',
                servicePrice: 0,
                hasAdvertising: false,
                monthlyAdSpend: 0,
                customerCount: 500
            };
            
            currentStep = 1;
            isProcessing = false;
            currentPrice = 0;
            currentAdSpend = 0;
            currentCustomers = 500;
            
            if (priceTimeout) clearTimeout(priceTimeout);
            if (adSpendTimeout) clearTimeout(adSpendTimeout);
            if (customerTimeout) clearTimeout(customerTimeout);
            
            updateStepIndicator(1);
            showBusinessTypeQuestion();
        }

        // Initialize calculator on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize header
            const randomIndex = Math.floor(Math.random() * headerVariations.length);
            const selected = headerVariations[randomIndex];
            const headerTitle = document.getElementById('headerTitle');
            if (headerTitle) {
                headerTitle.textContent = selected.title;
            }
            
            // Start calculator
            showBusinessTypeQuestion();
        });
    </script>
</body>
</html>